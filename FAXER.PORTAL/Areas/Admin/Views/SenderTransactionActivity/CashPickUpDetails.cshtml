@model FAXER.PORTAL.Models.SenderTransactionHistoryViewModel
@{
    ViewBag.Title = "CashPickUpDetails";
    Layout = "~/Areas/Admin/Views/Shared/New_Layout.cshtml";
}

<div class="pcoded-content">
    <div class="pcoded-inner-content">

        <div class="main-body">
            <div class="page-wrapper">

                <div class="page-body">
                    <div class="row">

                        <div class="col-sm-12">


                            <div>
                                <!-- item -->
                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.CashPickUp)
                                {

                                    <!-- CashPickUp -->
                                    foreach (var item in Model.TransactionHistoryList)
                                    {
                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>

                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>

                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">

                                                    <div class="dt-responsive table-responsive">

                                                        <table width="100%">

                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>MFCN: @item.Reference</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">

                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Status</td>
                                                                    <td class="text-left"> @item.StatusName</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>
                                                                <tr>

                                                                    <td class="text-left">City</td>
                                                                    <td class="text-left"> @item.ReceiverCity</td>

                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="formattedAmount">@item.GrossAmount</span> </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="formattedAmount">@item.Fee</span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="formattedAmount">@item.TotalAmount</span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol<span class="formattedAmount">@item.ReceivingAmount </span> </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate@item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Transfer Reference </td>
                                                                    <td class="text-left">@item.TransferReference</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Api Service</td>
                                                                    <td class="text-left">@item.ApiService</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>
                                                                </tr>
                                                                <tr></tr>
                                                                <tr></tr>
                                                            </tbody>

                                                        </table>
                                                    </div>


                                                </div>
                                            </div>

                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">

                                                        @if (item.Status == FAXER.PORTAL.DB.FaxingStatus.NotReceived || item.Status == FAXER.PORTAL.DB.FaxingStatus.Hold && ViewBag.VisibleReset == true)
                                                        {
                                                            <a class="btn btn-warning btn-round m-r-20" onclick="ResetTransaction('@item.Id','@Model.FilterKey ')"><i class="fa fa-refresh"></i> Reset</a>
                                                        }


                                                        @if (item.IsAwaitForApproval == true && ViewBag.VisibleApprove == true)
                                                        {
                                                            <a class="btn btn-success btn-round m-r-20" onclick="ApproveTransansation(@item.Id ,'@Model.FilterKey' )"><i class="fa fa-check"></i> Approve</a>
                                                        }
                                                        <a class="btn btn-secondary btn-round m-r-20" onclick="RecheckTransaction(@item.Id ,'@Model.FilterKey' )">
                                                            <i class="fa fa-refresh"></i>Recheck
                                                        </a>

                                                        @if (item.Status == FAXER.PORTAL.DB.FaxingStatus.NotReceived || item.Status == FAXER.PORTAL.DB.FaxingStatus.Hold || item.Status == FAXER.PORTAL.DB.FaxingStatus.PaymentPending && ViewBag.VisibleCancel == true)
                                                        {
                                                            <a class="btn btn-danger btn-round m-r-20" onclick="CancelTransaction(@item.Id,'@Model.FilterKey')"><i class="fa fa-remove"></i> Cancel</a>
                                                        }

                                                        @if (ViewBag.VisibleNewDetails == true)
                                                        {
                                                            <a href="@Url.Action("CreateNewbankDeposit", "SenderTransactionActivity",
                                                                 new { area = "Admin", Id = item.Id, TransactionServiceType = Model.FilterKey })" class="btn btn-dark btn-round m-r-20">
                                                                <i class="fa fa-plus"></i> Create New details
                                                            </a>


                                                        }
                                                        @if (ViewBag.VisibleUpdateProperty == true)
                                                        {
                                                            <a href="@Url.Action("UpdatePropertyOfTransaction", "SenderTransactionActivity",
                                                            new { area = "Admin", id = item.Id , transactionServiceType=Model.FilterKey})" class="btn btn-success btn-round m-r-20">
                                                                Update Property
                                                            </a>
                                                        }
                                                        <br />
                                                        <br />
                                                        @*@if (ViewBag.VisibleRefund == true)
                                                                   {
                                                               <a class="btn btn-primary radius-20" onclick="refundTransactionshowModal(@item.TotalAmount)">Refund</a>
                                                            }*@


                                                        @if ((item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.CreditDebitCard || item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.SavedDebitCreditCard)
                                                            && (item.Status == FAXER.PORTAL.DB.FaxingStatus.Cancel || item.Status == FAXER.PORTAL.DB.FaxingStatus.IdCheckInProgress))
                                                        {
                                                            <a class="btn btn-warning btn-round m-r-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">
                                                                <i class="fa fa-money"></i> Refund
                                                            </a>
                                                        }

                                                        @if (ViewBag.VisibleAmountAdjusment == true)
                                                        {

                                                        }


                                                        <br />
                                                        <a href="@Url.Action("printReceipt", "RefundsFormNonCardFaxingRefundRequest",
                                                                new { area = "Admin", MFCN = item.Reference })"
                                                           class="btn btn-primary btn-round m-r-20" target="_blank">
                                                            <i class="fa fa-print"></i>
                                                            print
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    }
                                }
                                <!-- item end -->
                                <!-- item -->
                                <!-- MobileWallet-->

                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.MobileWallet)
                                {

                                    foreach (var item in Model.TransactionHistoryList)
                                    {

                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>
                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>

                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">
                                                    <div class="dt-responsive table-responsive">
                                                        <table width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">
                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>Mobile Wallet</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>
                                                                <tr>

                                                                    <td class="text-left">City</td>
                                                                    <td class="text-left"> @item.ReceiverCity</td>

                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Wallet Name</td>
                                                                    <td class="text-left"> @item.WalletName</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Wallet No</td>
                                                                    <td class="text-left"> @item.AccountNumber</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.GrossAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.Fee</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.TotalAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol @item.ReceivingAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate @item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Transfer Reference </td>
                                                                    <td class="text-left">@item.TransferReference</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Api Service</td>
                                                                    <td class="text-left">@item.ApiService</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>

                                                                </tr>
                                                                <tr></tr>
                                                                <tr></tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">
                                                        <a href="@Url.Action("printReceiptOfMobileWallet",
                                                            "RefundsFormNonCardFaxingRefundRequest",
                                                            new { area = "Admin", @AccountNo = item.AccountNumber , @Id = item.Id})"
                                                           class="btn btn-primary btn-round m-r-20" target="_blank">
                                                            <i class="fa fa-print"></i>Print
                                                        </a>
                                                        @if (item.StatusofMobileTransfer != FAXER.PORTAL.DB.MobileMoneyTransferStatus.Paid && ViewBag.VisibleReset == true)
                                                        {
                                                            <a class="btn btn-warning btn-round m-r-20" onclick="ResetTransaction('@item.Id','@Model.FilterKey ')">
                                                                <i class="fa fa-refresh"></i>
                                                                Reset
                                                            </a>
                                                        }
                                                        <a class="btn btn-secondary btn-round m-r-20" onclick="RecheckTransaction(@item.Id ,'@Model.FilterKey' )">
                                                            <i class="fa fa-refresh"></i> Recheck
                                                        </a>
                                                        @if (item.IsAwaitForApproval == true && ViewBag.VisibleApprove == true)
                                                        {
                                                            <a class="btn btn-success btn-round m-r-20" onclick="ApproveTransansation(@item.Id ,'@Model.FilterKey')">
                                                                <i class="fa fa-check"></i>   Approve
                                                            </a>
                                                        }

                                                        @if (ViewBag.VisibleUpdateProperty == true)
                                                        {
                                                            <a href="@Url.Action("UpdatePropertyOfTransaction", "SenderTransactionActivity",
                                                            new { area = "Admin", id = item.Id , transactionServiceType=Model.FilterKey})" class="btn btn-success btn-round m-r-20">
                                                                Update Property
                                                            </a>

                                                        }


                                                        @if (item.StatusofMobileTransfer != FAXER.PORTAL.DB.MobileMoneyTransferStatus.Paid && ViewBag.VisibleCancel == true)
                                                        {
                                                            <a class="btn btn-danger btn-round m-r-20" onclick="CancelTransaction(@item.Id,'@Model.FilterKey')"><i class="fa fa-remove"></i> Cancel</a>
                                                        }

                                                        <br />
                                                        <br />
                                                        @if (ViewBag.VisibleNewDetails == true)
                                                        {
                                                            <a href="@Url.Action("CreateNewbankDeposit", "SenderTransactionActivity",
                                                            new { area = "Admin", Id = item.Id ,TransactionServiceType= Model.FilterKey})" class="btn btn-default btn-round m-r-20">
                                                                <i class="fa fa-plus"></i> Create New details
                                                            </a>
                                                        }
                                                        @*@if (ViewBag.VisibleRefund == true)
                                                            {
                                                                <a class="btn btn-primary radius-20" onclick="refundTransactionshowModal(@item.TotalAmount)">Refund</a>
                                                            }*@
                                                        <br />
                                                        @if ((item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.CreditDebitCard || item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.SavedDebitCreditCard)
                                                             && (item.StatusofMobileTransfer == FAXER.PORTAL.DB.MobileMoneyTransferStatus.Cancel || item.StatusofMobileTransfer == FAXER.PORTAL.DB.MobileMoneyTransferStatus.IdCheckInProgress))

                                                        {
                                                            <a class="btn btn-warning btn-round m-r-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">
                                                                <i class="fa fa-money"></i> Refunds
                                                            </a>
                                                        }
                                                        @if (ViewBag.VisibleAmountAdjusment == true)
                                                        {
                                                        }

                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    }
                                }
                                <!-- item end -->
                                <!-- item -->
                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.BankDeposit)
                                {
                                    <!-- BankDeposit -->
                                    foreach (var item in Model.TransactionHistoryList)
                                    {
                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>
                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>

                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">
                                                    <div class="dt-responsive table-responsive">
                                                        <table width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">
                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>Bank Deposit</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Status</td>
                                                                    <td class="text-left"> @item.TransactionStatusForAdmin</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Bank Name</td>
                                                                    <td class="text-left"> @item.BankName</td>
                                                                </tr>
                                                                @if (item.IsEuropeTransfer == true)
                                                                {

                                                                    <tr>
                                                                        <td class="text-left">BIC/SWIFT</td>
                                                                        <td class="text-left"> @item.BankCode</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="text-left">IBAN</td>
                                                                        <td class="text-left"> @item.AccountNumber</td>
                                                                    </tr>
                                                                }
                                                                else
                                                                {
                                                                    <tr>
                                                                        <td class="text-left">Bank Code</td>
                                                                        <td class="text-left"> @item.BankCode</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="text-left">Account No</td>
                                                                        <td class="text-left"> @item.AccountNumber</td>
                                                                    </tr>
                                                                }

                                                                <tr>
                                                                    <td class="text-left">Reference</td>
                                                                    <td class="text-left"> @item.Reference</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="GrossAmount">@item.GrossAmount</span> </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="Fee">@item.Fee </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol<span class="TotalAmount">@item.TotalAmount </span></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol<span class="ReceiveAmount">@item.ReceivingAmount </span> </td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate@item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Transfer Reference </td>
                                                                    <td class="text-left">@item.TransferReference</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">MF Reference</td>
                                                                    <td class="text-left">@item.TransactionIdentifier</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>
                                                                </tr>
                                                                <tr></tr>
                                                                <tr></tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">


                                                        @*<button class="btn btn-primary radius-20" onclick="repeat('@item.AccountNumber', @item.Id)"> Pay Account Again</button>
                                                            @*<button class="btn btn-warning radius-20">Print</button>*@
                                                        <a href="@Url.Action("printReceiptOfManualDeposit", "RefundsFormNonCardFaxingRefundRequest", new { area = "Admin", @AccountNo = item.AccountNumber , @Id = item.Id})"
                                                           class="btn btn-primary btn-round m-r-20" target="_blank">
                                                            <i class="fa fa-print"></i> Print
                                                        </a>

                                                        @if (item.IsManualBankDeposit)
                                                        {

                                                            if (item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.Incomplete
                                                                || item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.UnHold
                                                                || item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.Held)
                                                            {
                                                                <a href="@Url.Action("HoldUnhold", "SenderTransactionActivity",
                                                                    new { area = "Admin", id = item.Id, SenderId = ViewBag.SenderId })"
                                                                   class="btn btn-warning btn-round m-r-20">
                                                                    @if (item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.Held)
                                                                    {
                                                                        <span> Unhold </span>
                                                                    }
                                                                    else if (item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.UnHold || item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.Incomplete)
                                                                    {
                                                                        <span style=" width: 200px"> hold </span>
                                                                    }

                                                                </a>
                                                            }
                                                        }

                                                        @if (item.StatusOfBankDepoist != FAXER.PORTAL.DB.BankDepositStatus.Confirm && ViewBag.VisibleReset == true)
                                                        {

                                                            <a class="btn btn-warning btn-round m-r-20" onclick="ResetTransaction('@item.Id','@Model.FilterKey')">
                                                                <i class="fa fa-refresh"></i>    Reset
                                                            </a>
                                                        }

                                                        <a class="btn btn-secondary btn-round m-r-20" onclick="RecheckTransaction(@item.Id ,'@Model.FilterKey' )">
                                                            <i class="fa fa-refresh"></i>    Recheck
                                                        </a>
                                                        <br />
                                                        <br />
                                                        @if (item.IsAwaitForApproval == true && ViewBag.VisibleApprove == true)
                                                        {
                                                            <a class="btn btn-success btn-round m-r-20" onclick="ApproveTransansation(@item.Id,'@Model.FilterKey' )">
                                                                <i class="fa fa-check"></i>
                                                                Approve
                                                            </a>
                                                        }
                                                        @if (item.StatusOfBankDepoist != FAXER.PORTAL.DB.BankDepositStatus.Confirm && item.StatusOfBankDepoist != FAXER.PORTAL.DB.BankDepositStatus.Cancel && ViewBag.VisibleCancel == true)
                                                        {
                                                            <a class="btn btn-danger btn-round m-r-20" onclick="CancelTransaction(@item.Id,'@Model.FilterKey')"><i class="fa fa-remove"></i> Cancel</a>
                                                        }

                                                        <br />

                                                        @if (ViewBag.VisibleNewDetails == true)
                                                        {
                                                            <a href="@Url.Action("CreateNewbankDeposit", "SenderTransactionActivity",
                                                            new { area = "Admin", Id = item.Id ,TransactionServiceType= Model.FilterKey})" class="btn btn-default btn-round m-r-20">
                                                                <i class="fa fa-plus"></i>Create New details
                                                            </a>


                                                        }

                                                        <br />
                                                        @if (ViewBag.VisibleUpdateProperty == true)
                                                        {
                                                            <a href="@Url.Action("UpdatePropertyOfTransaction", "SenderTransactionActivity",
                                                            new { area = "Admin", id = item.Id , transactionServiceType=Model.FilterKey})" class="btn btn-success btn-round m-r-20">
                                                                Update Property
                                                            </a>
                                                        }
                                                        @*@if (ViewBag.VisibleRefund == true)
                                                                {
                                                            <a class="btn btn-primary radius-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">Refund</a>
                                                            }*@

                                                        @if ((item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.CreditDebitCard || item.SenderPaymentMode == FAXER.PORTAL.Models.SenderPaymentMode.SavedDebitCreditCard)
                                                               && (item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.Cancel || item.StatusOfBankDepoist == FAXER.PORTAL.DB.BankDepositStatus.IdCheckInProgress))


                                                        {
                                                            <a class="btn btn-primary btn-round m-r-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">
                                                                <i class="fa fa-money"></i>Refund
                                                            </a>
                                                        }

                                                        @if (ViewBag.VisibleAmountAdjusment == true)
                                                        {

                                                        }
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    }
                                }
                                <!-- item end -->
                                <!-- item -->
                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.KiiPayWallet)
                                {
                                    <!-- KiiPayWallet -->
                                    foreach (var item in Model.TransactionHistoryList)
                                    {
                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>
                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>

                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">
                                                    <div class="dt-responsive table-responsive">
                                                        <table width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">
                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>KiiPay Wallet</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>
                                                                <tr>

                                                                    <td class="text-left">City</td>
                                                                    <td class="text-left"> @item.ReceiverCity</td>

                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Wallet No</td>
                                                                    <td class="text-left"> @item.AccountNumber</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Reference </td>
                                                                    <td class="text-left"> @item.Reference</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.GrossAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.Fee</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.TotalAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol @item.ReceivingAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate @item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                @*<tr>
                                                                        <td class="text-left">Transfer Reference </td>
                                                                        <td class="text-left">@item.TransferReference</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="text-left">Api Service</td>
                                                                        <td class="text-left">@item.ApiService</td>
                                                                    </tr>*@
                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>

                                                                </tr>
                                                                <tr></tr>
                                                                <tr></tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">
                                                        <a href="@Url.Action("printReceiptKiiPay", "RefundsFormNonCardFaxingRefundRequest", new { area = "Admin", id = item.Id })"
                                                           class="btn btn-primary btn-round m-r-20" target="_blank">  <i class="fa fa-print"></i>print</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                                <!-- item end -->
                                <!-- item -->
                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.BillPayment)
                                {
                                    <!-- BillPayment -->
                                    foreach (var item in Model.TransactionHistoryList)
                                    {
                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>
                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>


                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">
                                                    <div class="dt-responsive table-responsive">
                                                        <table width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">
                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>Bill Payment</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>
                                                                <tr>

                                                                    <td class="text-left">City</td>
                                                                    <td class="text-left"> @item.ReceiverCity</td>

                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Wallet No</td>
                                                                    <td class="text-left"> @item.AccountNumber</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Bill Reference No.</td>
                                                                    <td class="text-left"> @item.BillReferenceNo</td>
                                                                </tr>


                                                                @if (item.BillpaymentCode == "BP")
                                                                {
                                                                    <tr>
                                                                        <td class="text-left">Bill No.</td>
                                                                        <td class="text-left"> @item.BillNo</td>
                                                                    </tr>
                                                                }
                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.GrossAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.Fee</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.TotalAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol @item.ReceivingAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate @item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                @*<tr>
                                                                        <td class="text-left">Transfer Reference </td>
                                                                        <td class="text-left">@item.TransferReference</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="text-left">Api Service</td>
                                                                        <td class="text-left">@item.ApiService</td>
                                                                    </tr>*@

                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>

                                                                </tr>
                                                                <tr></tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">
                                                        <a href="" class="btn btn-warning btn-round m-r-20">Print</a>
                                                        <a class="btn btn-primary btn-round m-r-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">Refund</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                                <!-- item end -->
                                <!-- item -->
                                @if (Model.FilterKey == FAXER.PORTAL.Models.TransactionServiceType.ServicePayment)
                                {
                                    <!-- ServicePayment -->
                                    foreach (var item in Model.TransactionHistoryList)
                                    {

                                        <div class="card">
                                            <div class="card-header border-bottom">
                                                <h4 class="f-left f-left m-t-5 m-b-0">
                                                    <label class="text-primary">@item.SenderName </label>
                                                    <span>
                                                        Account No: @item.FaxerAccountNo
                                                        <br>Country:  @item.FaxerCountry
                                                    </span>
                                                </h4>
                                                <button onclick="window.history.go(-1);" class=" btn btn-primary f-right btn-round">
                                                    <i class="fa fa-angle-left m-r-5"></i> Back
                                                </button>
                                                <button onclick="BanReceiverAndSender(@item.senderId , @item.RecipientId);" class=" btn btn-danger f-right btn-round">
                                                    <i class="fa fa-ban m-r-5"></i> Ban Sender &  Recipient
                                                </button>

                                            </div>
                                            <div class="card-body">
                                                <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3">
                                                    <div class="dt-responsive table-responsive">
                                                        <table width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="p-t-10 p-b-10">
                                                                            <h5>  @item.ReceiverName</h5>
                                                                            <span class="text-primary">@item.Date</span>
                                                                        </div>
                                                                    </td>

                                                                    <td align="right">
                                                                        <div class="p-t-10 p-b-10">

                                                                            <h5>Service Payment</h5>
                                                                            <span class="text-success">@item.SendingCurrencySymbol @item.TotalAmount @item.SendingCurrency</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <table class="table table-striped table-bordered nowrap">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="text-left">Name</td>
                                                                    <td class="text-left"> @item.ReceiverName</td>
                                                                </tr>
                                                                <tr>

                                                                    <td class="text-left">City</td>
                                                                    <td class="text-left"> @item.ReceiverCity</td>

                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Country</td>
                                                                    <td class="text-left"> @item.ReceiverCountry</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Wallet No</td>
                                                                    <td class="text-left"> @item.AccountNumber</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Reference</td>
                                                                    <td class="text-left"> @item.Reference</td>
                                                                </tr>

                                                                <tr>
                                                                    <td class="text-left">Sending Amount</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.GrossAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Fee</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.Fee</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Amount Paid</td>
                                                                    <td class="text-left"> @item.SendingCurrencySymbol @item.TotalAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">@item.ReceiverName will Receive</td>
                                                                    <td class="text-left"> @item.ReceivingCurrencySymbol @item.ReceivingAmount</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Exchange Rate</td>
                                                                    <td class="text-left"> 1 @item.SendingCurrency = @item.ExchangeRate @item.ReceivingCurrrency</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-left">Payment Method</td>
                                                                    <td class="text-left">@item.PaymentMethod</td>
                                                                </tr>
                                                                @*<tr>
                                                                        <td class="text-left">Transfer Reference </td>
                                                                        <td class="text-left">@item.TransferReference</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="text-left">Api Service</td>
                                                                        <td class="text-left">@item.ApiService</td>
                                                                    </tr>*@
                                                                <tr>
                                                                    <td class="text-left">Date</td>
                                                                    <td class="text-left">@item.Date</td>

                                                                </tr>
                                                                <tr></tr>
                                                                <tr></tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-light">
                                                <div class="row">
                                                    <div class="col-lg-6  col-sm-12 col-xs-12 offset-lg-3 text-center">
                                                        <a href="" class="btn btn-warning btn-round m-r-20">Print</a>
                                                        <a class="btn btn-primary btn-round m-r-20" onclick="refundTransactionshowModal(@item.TotalAmount ,'@item.Id' ,'@Model.FilterKey')">Refund</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }

                                <!-- item end -->
                                <!--  btn -->
                                <div class="clearfix ">

                                    <center>
                                        <a href="javascript:history.back()" class=" "><i class="fa fa-chevron-left" aria-hidden="true"></i> Go Back </a>
                                    </center>
                                </div>
                                <!--  btn end-->

                            </div>




                        </div>

                    </div>


                </div>
            </div>
        </div>




        <div class="modal" id="transactionState" role="dialog">
            <div class="modal-dialog modal-md">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title">Transaction State</h4>
                    </div>
                    <div class="modal-body">

                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                                <div class="icon_al">
                                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-8">
                                <p>Api Transaction Reference : <span id="transactioRef"></span> </p>
                                <p>MF Transaction Reference : <span id="transactionReceiptNo"></span> </p>
                                <p>Transaction Report : <span id="transactionErrorMsg"></span> </p>
                                <p>Transaction Status : <span id="transactioStatus"></span> </p>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Ok</button>
                    </div>

                </div>
            </div>
        </div>


        <div class="modal" id="transactionReset" role="dialog">
            <div class="modal-dialog modal-md">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" onclick="ReloadPage()">×</button>
                        <h4 class="modal-title">Transaction ReInitialization</h4>

                    </div>
                    <div class="modal-body">

                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                                <div class="icon_al">
                                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-8">
                                <p>ReceiptNo : <span id="receiptNo"></span> </p>
                                <p>  <span id="transReIntiateMsg"></span> </p>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger btn-sm" onclick="ReloadPage()">Ok</button>
                    </div>

                </div>
            </div>
        </div>

        <div class="modal" id="transactionApproveResult" role="dialog">
            <div class="modal-dialog modal-md">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" onclick="ReloadPage()" id="CloseBtnHeader">×</button>
                        <h4 class="modal-title">Approve Transaction</h4>
                    </div>
                    <div class="modal-body">

                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                                <div class="icon_al">
                                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-8">
                                <p id="ApprovalMessage">Approve Successfully!!!</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger btn-sm" id="CloseBtnFooter" onclick="ReloadPage()">Ok</button>
                    </div>

                </div>
            </div>
        </div>


        <div class="modal" id="CancelTransactionModal" role="dialog">
            <div class="modal-dialog modal-md">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" onclick="ReloadPage()" id="CloseBtnHeader">×</button>
                        <h4 class="modal-title">Transaction Cancellation </h4>
                    </div>
                    <div class="modal-body">

                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4">
                                <div class="icon_al">
                                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-8">
                                <p id="CancelMessage">Cancelled Successfully!!!</p>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger btn-sm" id="CloseBtnFooter" onclick="ReloadPage()">Ok</button>
                    </div>

                </div>
            </div>
        </div>
        @using (Html.BeginForm("RefundTransaction", "SenderTransactionActivity", FormMethod.Post))
        {
            <div class="modal" id="RefundTransaction" role="dialog">
                <div class="modal-dialog modal-md">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title"> Refund</h4>
                            <button type="button" class="close" onclick="ReloadPage()" id="CloseBtnHeader">×</button>

                        </div>
                        <div class="modal-body">

                            <div class="row">

                                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-8">

                                    @Html.HiddenFor(x => x.FilterKey)
                                    @Html.HiddenFor(x => x.Id)
                                    <div class="form-group">
                                        @*@Html.EnumDropDownListFor(x => x.RefundTransactionViewModel.RefundType,
                                             new{
                                                  @class ="",
                                                  @placeholder = "select Refund Type",
                                                  @id = "refundType",
                                                  @onchange = "RefundTypeChangeEvent()"
                                            })
                                             @Html.ValidationMessage("refundTypeValidation", "", new { @class = "text-danger", @id = "refundTypeValidation" })*@

                                        @Html.EnumDropDownListFor(x => x.RefundTransactionViewModel.RefundType,
                                      new
                                           {
                                          @class = "",
                                          @placeholder = "select Refund Type",
                                          @id = "refundType",
                                          @onchange = "RefundTypeChangeEvent()"
                                      })
                                        @Html.ValidationMessage("refundTypeValidation", "", new { @class = "text-danger", @id = "refundTypeValidation" })


                                    </div>
                                    <div class="form-group">
                                        @Html.TextBoxFor(x => x.RefundTransactionViewModel.ReceiverName,
                                       new
                                            {
                                                @class = "form-control form-control-lg form-control-round form-control-bold",
                                           @id = "ReceiverName",
                                                @placeholder = "Recipient Name"
                                            })
                                        @Html.ValidationMessage("refundTypeValidation", "", new
                                        {
                                            @class = "text-danger",
                                       @id = "ReceiverNameValidation"
                                        })
                                    </div>
                                    <div class="form-group">
                                        @Html.TextBoxFor(x => x.RefundTransactionViewModel.ReceiptNo,
                                       new
                                            {
                                                @class = "form-control form-control-lg form-control-round form-control-bold",
                                           @id = "ReceiptNo",
                                                @placeholder = "Reference No"
                                            })
                                        @Html.ValidationMessage("refundTypeValidation", "", new
                                   {
                                       @class = "text-danger",
                                       @id = "ReceipentNoValidation"
                                   })
                                    </div>
                                    <div class="form-group">
                                        @Html.TextBoxFor(x => x.RefundTransactionViewModel.RefundingAmount,
                                       new
                                            {
                                                @class = "form-control form-control-lg form-control-round form-control-bold",
                                           @placeholder = "Enter Amount",
                                                @id = "RefundingAmount"
                                            })
                                        @Html.ValidationMessage("refundTypeValidation", "", new
                                        {
                                            @class = "text-danger",
                                       @id = "RefundingAmountValidation"
                                        })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary btn-sm" onclick="refundTransaction();">Confirm </button>
                        </div>

                    </div>
                </div>
            </div>
        }

    </div>
</div>

@section Scripts
    {

    <script type="text/javascript">

        function ReloadPage() {

            window.location.reload();
        }

        var RefundAmount = 0;
        function refundTransactionshowModal(TotalAmount, transactionId, transactionServiceType) {

            RefundAmount = TotalAmount;
            $.getJSON("/Admin/SenderTransactionActivity/GetTransactionDetailsForRefund?transactionId=" + transactionId + "&transactionServiceType=" + transactionServiceType, function (result) {
                debugger;
                $("#ReceiverName").val(result.Data.ReceiverName);
                $("#ReceiptNo").val(result.Data.ReceiptNo);
                RefundAmount = result.Data.RefundingAmount;
                $("#RefundTransaction").modal('show');

            });

            $("#RefundTransaction").modal('show');

        }

        function RefundTypeChangeEvent() {
            var refundType = $("#refundType").val();
            if (refundType == 2) {
                $("#RefundingAmount").val(RefundAmount);

            }
            else {
                $("#RefundingAmount").val(0);

            }


        }
        function refundTransaction() {
            var RefundType = $("#refundType").val();
            var ReceiverName = $("#ReceiverName").val();
            var RefundingAmount = $("#RefundingAmount").val();

            if (RefundType == 0) {
                $("#refundTypeValidation").text('Select Refund type');
                return;
            }
            if (ReceiverName == "") {
                $("#ReceiverNameValidation").text('Enter receiver name');
                return;
            }
            if (RefundingAmount == 0) {
                $("#RefundingAmountValidation").text('Enter amount');
                return;
            }
            else {
                if (RefundType == 2) {

                    if (RefundingAmount > RefundAmount) {
                        $("#RefundingAmountValidation").text('Amount should be equal to Total amount');
                        return;
                    }
                }
                else {
                    if (RefundingAmount >= RefundAmount) {
                        $("#RefundingAmountValidation").text('Amount should be less than Total amount');
                        return;
                    }
                }

            }

            $("form")[0].submit();
        }

        function RecheckTransaction(id, transactionServiceType) {
            $.getJSON("/Admin/SenderTransactionActivity/RecheckTransaction?transactionId=" + id + "&transactionServiceType=" + transactionServiceType, function (result) {
                $("#transactioRef").text(result.Data.Reference);
                $("#transactioStatus").text(result.Data.Status);
                $("#transactionErrorMsg").text(result.Data.ErrorMessage);
                $("#transactionReceiptNo").text(result.Data.ReceiptNo);

                $("#transactionState").modal('show');
            });
        }

        function ResetTransaction(Id, transactionServiceType) {
            $.getJSON("/Admin/SenderTransactionActivity/ResetTransaction?transactionId=" + Id + "&transactionServiceType=" + transactionServiceType, function (result) {
                $("#receiptNo").text(result.Data.NewReceiptNo);
                $("#transReIntiateMsg").text(result.Data.TransactionReport);
                $("#transactionReset").modal('show');

            });
        }

        function ApproveTransansation(Id, transactionServiceType) {
            $.getJSON("/Admin/SenderTransactionActivity/ApproveTransansation?transactionId=" + Id + "&transactionServiceType=" + transactionServiceType,
                function (result) {

                    $("#ApprovalMessage").text(result.Data.Message);
                    $("#transactionApproveResult").modal('show');

                });
        }

        function CancelTransaction(id, transactionServiceType) {

            $.getJSON("/Admin/SenderTransactionActivity/CancelTransaction?transactionId=" + id + "&transactionServiceType=" + transactionServiceType,
                function (result) {
                    $("#CancelMessage").text(result.Message);
                    $("#CancelTransactionModal").modal('show');
                });
        }

        function BanReceiverAndSender(senderId, recipientId) {
            debugger;
            Riddha.UI.Confirm("Are you sure you want to ban receiver and sender?", function () {
                $.getJSON("/Admin/SenderTransactionActivity/BanReceiverAndSender?senderId=" + senderId + "&recipientId=" + recipientId, function (result) {
                    return Riddha.UI.SuccessPopUp("Sender and Recipient is banned", "Success", 0)
                })
            });
        }


    </script>
}


